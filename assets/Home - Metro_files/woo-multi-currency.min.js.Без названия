jQuery(document).ready(function($){"use strict";$(document.body).on("updated_checkout",function(b,a){a.hasOwnProperty("wmc_update_checkout")&&a.wmc_update_checkout&&$(document.body).trigger("update_checkout")}),$(document.body).on("payment_method_selected",function(a,b){"ppcp-gateway"===$('.woocommerce-checkout input[name="payment_method"]:checked').val()&&$(document.body).trigger("update_checkout")}),window.woo_multi_currency={init:function(){this.design(),this.checkPosition(),this.cacheCompatible(),this.ajaxComplete()},design:function(){768>=jQuery(window).width()?jQuery(".woo-multi-currency.wmc-sidebar").on("click",function(){jQuery(this).toggleClass("wmc-hover"),jQuery(this).hasClass("wmc-hover")?jQuery("html").css({overflow:"hidden"}):jQuery("html").css({overflow:"visible"})}):(jQuery(".woo-multi-currency.wmc-sidebar").on("mouseenter",function(){jQuery(this).addClass("wmc-hover")}),jQuery(".woo-multi-currency.wmc-sidebar").on("mouseleave",function(){jQuery(this).removeClass("wmc-hover")}))},checkPosition:function(){jQuery(".woo-multi-currency .wmc-currency-wrapper").on("mouseenter",function(){this.getBoundingClientRect().top/$(window).height()>.5?$(".woo-multi-currency .wmc-sub-currency").addClass("wmc-show-up"):$(".woo-multi-currency .wmc-sub-currency").removeClass("wmc-show-up")})},cacheCompatible(){if("1"===wooMultiCurrencyParams.enableCacheCompatible){if("undefined"!=typeof wc_checkout_params&&1===parseInt(wc_checkout_params.is_checkout))return;let a=[],c=$(".wmc-cache-pid");c.length&&c.each(function(d,c){let b=$(c).data("wmc_product_id");b&&a.push(b)});let d=$(".variations_form");d.length&&d.each(function(d,c){let b=$(c).data("product_variations");b.length&&b.forEach(b=>{a.push(b.variation_id)})});let e=$(".woo-multi-currency.wmc-shortcode").not(".wmc-list-currency-rates"),f=[];e.map(function(){let a=$(this);f.push({layout:a.data("layout")?a.data("layout"):"default",flag_size:a.data("flag_size")})}),a.length&&(a=[...new Set(a)]);let b=[];$(".wmc-cache-value").each(function(c,a){b.push({price:$(a).data("price"),original_price:$(a).data("original_price"),currency:$(a).data("currency"),product_id:$(a).data("product_id"),keep_format:$(a).data("keep_format")})}),b=[...new Set(b.map(JSON.stringify))].map(JSON.parse),$.ajax({url:wooMultiCurrencyParams.ajaxUrl,type:"POST",data:{action:"wmc_get_products_price",pids:a,shortcodes:f,wmc_current_url:$(".wmc-current-url").val(),exchange:b},success(a){if(a.success){let h=a.data.prices||"",d=a.data.current_currency||"",b=a.data.exchange||"";if(f.length>0&&f.length===a.data.shortcodes.length)for(let g=0;g<f.length;g++)e.eq(g).replaceWith(a.data.shortcodes[g]);if("1"!==wooMultiCurrencyParams.switchByJS&&$(".wmc-currency a").unbind(),d&&($(".wmc-sidebar .wmc-currency").removeClass("wmc-active"),$(`.wmc-sidebar .wmc-currency[data-currency=${d}]`).addClass("wmc-active"),$(".wmc-price-switcher .wmc-current-currency i").removeClass().addClass("vi-flag-64 flag-"+a.data.current_country),$(".wmc-price-switcher .wmc-sub-currency-current").removeClass("wmc-sub-currency-current"),$(`.wmc-price-switcher .wmc-currency[data-currency=${d}]`).addClass("wmc-sub-currency-current"),$(`select.wmc-nav option[data-currency=${d}]`).prop("selected",!0),$("body").removeClass(`woocommerce-multi-currency-${wooMultiCurrencyParams.current_currency}`).addClass(`woocommerce-multi-currency-${d}`)),"undefined"!=typeof woo_multi_currency_switcher&&woo_multi_currency_switcher.init(),h){for(let i in h)$(`.wmc-cache-pid[data-wmc_product_id=${i}]`).replaceWith(h[i]);$(".variations_form").each((c,b)=>{let a=$(b).data("product_variations");a&&(a.map(a=>{let b=a.variation_id;return a.price_html=h[b],a}),$(b).data("product_variations",a))})}if(b)for(let c in b)$(`.wmc-cache-value[data-price="${b[c].price}"][data-product_id="${b[c].product_id}"][data-keep_format="${b[c].keep_format}"][data-original_price="${b[c].original_price}"][data-currency="${b[c].currency}"]`).replaceWith(b[c].shortcode);jQuery(document.body).trigger("wmc_cache_compatible_finish",[a.data])}}})}},ajaxComplete(){$(document).on("append.infiniteScroll",()=>{this.cacheCompatible()})}},woo_multi_currency.init()})